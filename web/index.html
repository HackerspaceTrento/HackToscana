<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Bootstrap 101 Template</title>

    <link href="css/radar.css" rel="stylesheet">

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap-slider.min.css" rel="stylesheet">
    <link href="css/bootstrap-switch.min.css" rel="stylesheet">

    <link href="css/font-awesome.min.css" rel="stylesheet">

    <link href="css/layout.css" rel="stylesheet">

    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
    <link rel="stylesheet" href="lib/leaflet/leaflet-routing-machine.css" />
    <link rel="stylesheet" href="lib/mapzen/leaflet.routing.mapzen.css" />

    <link rel="stylesheet" href="css/jquery.circliful.css" />

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
<style>

/* body { */
/*     overflow: hidden; */
/* } */

.slider.slider-vertical {
  height: 100%;
}

.search-form {
  height: 100%;
}

.slider-wrapper {
  height: 70%;
  width: 70%;
}

.slider-single {
  height: 100%;
  width: 20%;
}

.slider-wrapper .slider {
  margin: auto 2%;
}

.slider-single i {
  display: block;
  margin-bottom: 20px;
}

.switch-wrapper {
  height: 40%;
  width: 30%;
  margin: 15% auto;
}

.switch-wrapper div i {
  display: block;
}

.switch-wrapper .bootstrap-switch {
  margin: 7% auto;
}
</style>

  </head>
  <body>
    <div class="container-fluid">
      <div id="wrapper">
        <div class="col-lg-8 col-xs-12 map"><div id="map"></div></div>
        <div class="col-lg-4 col-xs-12 sidebar">
          <!-- <h2>sidebar</h2> -->
          <div class="col-lg-12 col-xs-4 sidebar-widget infographic">
            <div class="badge-chart">
              <!-- <div id="badge" data&#45;dimension="250"></div> -->
            </div>
            <div class="badge-img"><img src="asd" /><h3>Ben fatto! Ti sei guadagnata una visita guidata all'Orto Botanico!</h3></div>
          </div>
          <div class="col-lg-12 col-xs-4 sidebar-widget score">
              <div id="radar-container">
                  <div class="sc michele">michele</div>
                  <div class="sc marco">marco</div>
                  <div class="sc anita">anita</div>
                  <div class="sc anna">anna</div>
                  <canvas id="radar" height="100%"></canvas>
              </div>
          </div>
          <div class="col-lg-12 col-xs-4 sidebar-widget search">
            <form action="" class="search-form">
              <div class="slider-wrapper pull-left">
                <div class="slider-single pull-left">
                  <i class="fa fa-leaf fa-2x"></i>
                  <input id="sustainability" name="sustainability" data-slider-id='sustainabilitySlider' class="bootstrap-slider pull-left" type="text" data-slider-min="1" data-slider-max="3" data-slider-step="1" data-slider-value="1" data-slider-orientation="vertical" data-slider-reversed="true" />
                </div>
                <div class="slider-single pull-left">
                  <i class="fa fa-heartbeat fa-2x"></i>
                  <input id="health" name="health" data-slider-id='healthSlider' class="bootstrap-slider pull-left" type="text" data-slider-min="1" data-slider-max="3" data-slider-step="1" data-slider-value="1" data-slider-orientation="vertical" data-slider-reversed="true" />
                </div>
                <div class="slider-single pull-left">
                  <i class="fa fa-tree fa-2x"></i>
                  <input id="nature" name="nature" data-slider-id='natureSlider' class="bootstrap-slider pull-left" type="text" data-slider-min="1" data-slider-max="3" data-slider-step="1" data-slider-value="1" data-slider-orientation="vertical" data-slider-reversed="true" />
                </div>
                <div class="slider-single pull-left">
                  <i class="fa fa-fort-awesome fa-2x"></i>
                  <input id="beauty" name="beauty" data-slider-id='beautySlider' class="bootstrap-slider pull-left" type="text" data-slider-min="1" data-slider-max="3" data-slider-step="1" data-slider-value="1" data-slider-orientation="vertical" data-slider-reversed="true" />
                </div>
                <div class="slider-single pull-left">
                  <i class="fa fa-clock-o fa-2x"></i>
                  <input id="time" name="time" data-slider-id='timeSlider' class="bootstrap-slider pull-left" type="text" data-slider-min="1" data-slider-max="3" data-slider-step="1" data-slider-value="1" data-slider-orientation="vertical" data-slider-reversed="true" />
                </div>
              </div>
              <div class="switch-wrapper pull-left">
                <div class="col-xs-12 text-center">
                  <i class="fa fa-cutlery fa-2x"></i>
                  <input type="checkbox" id="food" name="food" class="bootstrap-switch" />
                </div>
                <div class="col-xs-12 text-center">
                  <i class="fa fa-shopping-cart fa-2x"></i>
                  <input type="checkbox" id="shopping" name="shopping" class="bootstrap-switch" />
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
    <script src="lib/leaflet/leaflet-routing-machine.js"></script>
    <script src="lib/mapzen/lrm-mapzen.js"></script>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

    <!-- chartjs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.min.js"></script>
    <script src="js/radar.js"></script>

    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <script src="js/bootstrap-toolkit.min.js"></script>
    <script src="js/bootstrap-slider.min.js"></script>
    <script src="js/bootstrap-switch.min.js"></script>

    <script src="js/jquery.circliful.min.js"></script>
    <script>
    var map,
    route;

$(function () {
  // With JQuery

  $.fn.serializeObject = function()
  {
    var o = {};
    var a = this.serializeArray();
    $.each(a, function() {
      if (o[this.name] !== undefined) {
        if (!o[this.name].push) {
          o[this.name] = [o[this.name]];
        }
        o[this.name].push(this.value || '');
      } else {
        o[this.name] = this.value || '';
      }
    });
    return o;
  };

  function initMap() {
    map = L.map('map').setView([43.7777988,11.2344857], 13);
    L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw', {
        maxZoom: 18,
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
        '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
        'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
        id: 'mapbox.streets'
        }).addTo(map);
  }

  function updatePath() {
    var formData = dumpForm();
    if (route) {
      route.removeFrom(map);
    }
    if (formData.food) {
    route = L.Routing.control({
      waypoints: [
        L.latLng(43.7780042,11.2449093),
        L.latLng(43.7749619,11.2538762),
        L.latLng(43.774317,11.267622),
        L.latLng(43.7701208,11.2672878)
      ],
      router: L.Routing.mapzen('valhalla-48_NtvI', 'pedestrian'), 
      formatter: new L.Routing.Mapzen.Formatter(), 
      summaryTemplate:'<div class="start">{name}</div><div class="info {transitmode}">{distance}, {time}</div>',
      routeWhileDragging: true
    }).addTo(map);
    } else {
    route = L.Routing.control({
      waypoints: [
        L.latLng(43.7780042,11.2449093),
        L.latLng(43.7701208,11.2672878)
      ],
      router: L.Routing.mapzen('valhalla-48_NtvI', 'pedestrian'), 
      formatter: new L.Routing.Mapzen.Formatter(), 
      summaryTemplate:'<div class="start">{name}</div><div class="info {transitmode}">{distance}, {time}</div>',
      routeWhileDragging: true
    }).addTo(map);
    }
  }

  function dumpForm() {
    return $('.search-form :input').serializeObject();
  }

  initMap();
  $('.bootstrap-slider').slider();

  $('.bootstrap-switch').bootstrapSwitch();

  $('.search-form .slider-wrapper :input').change(updatePath);
  $('.search-form .switch-wrapper :input').on('switchChange.bootstrapSwitch', updatePath);

  // $('#badge').circliful();
});

  var $badge_img = $('.badge-img'),
      $badge_chart = $('.badge-chart'),
      $badge = $('#badge', $badge_chart);

  function showBadge(person) {
    var personData = peopleData[person];
    showBadgeChart(personData);
    if (personData.winner) {
      setTimeout(function(){
          showBadgeImage(personData);
      },3000);
    }
  }

  function showBadgeImage(personData) {
    $badge_chart.hide();
    $badge_img.show();
    $('img',$badge_img).attr('src', 'img/' + personData.path);
  }

  function showBadgeChart(personData) {
    $badge_img.hide();
    $badge_chart.html(buildChart(personData.chart_cfg));
    $badge_chart.show();
  }

  function buildChart(data) {
    var addData = function (s){
      var r = { id : 'badge'};
      for (k in s) { r['data-' + k] = s[k]; }
      return r;
    },
    tt = $('<div/>', addData(data));
    tt.circliful();
    return tt;
  }

// showBadgeChart({ chart_cfg : {
//       dimension:"250",
//       text:"35%",
//       info:"New Clients",
//       width:30,
//       fontsize:38,
//       percent:35,
//       fgcolor:"#61a9dc",
//       bgcolor:"#eee",
//       fill:"#ddd",
//       total:200,
//       part:35,
//       icon:"long-arrow-up",
//       iconsize:28,
//       iconcolor:"#fff"
// }});


    (function($, viewport){
      var cur_size;

      function update_body_layout_class() {
        var $body    = $('body'),
            new_size = viewport.current();
        $body.removeClass(cur_size);
        $body.addClass(new_size);
        cur_size = new_size;
      }

      $(function () {
        update_body_layout_class();
        $(window).resize(viewport.changed(update_body_layout_class));
      });
    })(jQuery, ResponsiveBootstrapToolkit);</script>
  </body>
</html>
